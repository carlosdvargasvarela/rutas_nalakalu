<h1 class="mb-4">
  <i class="bi bi-receipt me-2"></i>
  Pedido <span class="text-primary">#<%= @order.number %></span>
</h1>

<div class="row mb-4">
  <div class="col-md-4 mb-2">
    <div class="card shadow-sm">
      <div class="card-body">
        <h6 class="card-title text-secondary mb-2">
          <i class="bi bi-person me-1"></i>Cliente
        </h6>
        <p class="mb-0"><%= @order.client.name %></p>
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-2">
    <div class="card shadow-sm">
      <div class="card-body">
        <h6 class="card-title text-secondary mb-2">
          <i class="bi bi-person-badge me-1"></i>Vendedor
        </h6>
        <p class="mb-0">
          <%= @order.seller.name %>
          <span class="text-muted small">(<%= @order.seller.seller_code %>)</span>
        </p>
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-2">
    <div class="card shadow-sm">
      <div class="card-body">
        <h6 class="card-title text-secondary mb-2">
          <i class="bi bi-flag me-1"></i>Estado
        </h6>
        <% status_class = case @order.status
          when "pending" then "bg-warning text-dark"
          when "in_production" then "bg-info"
          when "ready_for_delivery" then "bg-primary"
          when "delivered" then "bg-success"
          when "cancelled" then "bg-danger"
          else "bg-secondary"
        end %>
        <span class="badge <%= status_class %>">
          <%= @order.status.humanize %>
        </span>
      </div>
    </div>
  </div>
</div>

<h2 class="mt-4 mb-3">
  <i class="bi bi-box-seam me-2"></i>
  Productos del pedido
</h2>

<div class="table-responsive">
  <table class="table table-striped table-hover align-middle">
    <thead class="table-light">
      <tr>
        <th>Producto</th>
        <th>Cantidad</th>
        <th>Notas</th>
        <th>Confirmaci贸n</th>
        <th>Acci贸n</th>
      </tr>
    </thead>
    <tbody>
      <% @order.order_items.each do |item| %>
        <tr>
          <td><strong><%= item.product %></strong></td>
          <td>
            <span class="badge bg-secondary"><%= item.quantity %></span>
          </td>
          <td>
            <% if item.notes.present? %>
              <span class="text-muted"><i class="bi bi-info-circle"></i> <%= item.notes %></span>
            <% else %>
              <span class="text-muted">N/A</span>
            <% end %>
          </td>
          <td>
            <% if item.confirmed? %>
              <span class="badge bg-success"><i class="bi bi-check-circle me-1"></i>Confirmado</span>
            <% else %>
              <span class="badge bg-secondary"><i class="bi bi-hourglass-split me-1"></i>Pendiente de Confirmaci贸n</span>
            <% end %>
          </td>
          <td>
            <% if item.confirmed? %>
              <%= button_to unconfirm_order_item_path(item), method: :patch, class: "btn btn-warning btn-sm", title: "Retirar confirmaci贸n" do %>
                <i class="bi bi-x-circle"></i> Retirar
              <% end %>
            <% else %>
              <%= button_to confirm_order_item_path(item), method: :patch, class: "btn btn-primary btn-sm", title: "Confirmar" do %>
                <i class="bi bi-check-circle"></i> Confirmar
              <% end %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<%= link_to orders_path, class: "btn btn-secondary mt-3" do %>
  <i class="bi bi-arrow-left"></i> Volver a Pedidos
<% end %>