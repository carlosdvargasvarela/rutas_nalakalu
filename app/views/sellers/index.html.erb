<!-- app/views/sellers/index.html.erb -->

<div class="container-fluid py-4">
  <!-- Header estilo dashboard -->
  <div class="dashboard-header mb-4">
    <div class="row align-items-center position-relative">
      <div class="col-md-8">
        <h2 class="fw-bold mb-3">
          <i class="bi bi-person-badge me-2"></i>
          Vendedores
        </h2>
        <p class="text-white-50 mb-2">
          Gestión y consulta de vendedores registrados
        </p>
        <p class="fst-italic text-white-50 mb-0">"Impulsando el éxito de tu equipo de ventas."</p>
      </div>
      <div class="col-md-4 text-md-end mt-3 mt-md-0">
        <div class="btn-toolbar justify-content-md-end gap-2 flex-wrap">
          <button class="btn btn-light btn-lg rounded-3 dashboard-action-btn" type="button" data-bs-toggle="collapse" data-bs-target="#filters">
            <i class="bi bi-funnel me-1"></i> Filtros
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- Filtros -->
  <div id="filters" class="collapse mb-4">
    <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
      <div class="card-header bg-gradient text-white py-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <i class="bi bi-funnel me-2"></i>Filtros de búsqueda
      </div>
      <div class="card-body p-4">
        <%= search_form_for @q, url: sellers_path, method: :get, builder: SimpleForm::FormBuilder, html: { class: "row g-4" } do |f| %>
          <div class="col-md-4">
            <%= f.input :name_cont, label: "Nombre contiene", input_html: { placeholder: "Ej. Juan López", class: "form-control form-control-lg rounded-3" } %>
          </div>
          <div class="col-md-4">
            <%= f.input :seller_code_cont, label: "Código contiene", input_html: { placeholder: "Ej. V001", class: "form-control form-control-lg rounded-3" } %>
          </div>
          <div class="col-md-4">
            <%= f.input :user_email_cont, label: "Correo del usuario", input_html: { placeholder: "usuario@empresa.com", class: "form-control form-control-lg rounded-3" } %>
          </div>
          <div class="col-12 d-flex gap-2 mt-2">
            <%= f.submit "Aplicar filtros", class: "btn btn-outline-primary btn-lg rounded-pill px-4" %>
            <%= link_to "Limpiar", sellers_path, class: "btn btn-outline-secondary btn-lg rounded-pill px-4" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <!-- Tabla de vendedores -->
  <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th class="py-3 px-4 fw-semibold text-muted"><%= sort_link(@q, :name, "Nombre") %></th>
            <th class="py-3 px-4 fw-semibold text-muted">Código</th>
            <th class="py-3 px-4 fw-semibold text-muted">Usuario</th>
            <th class="py-3 px-4 text-end fw-semibold text-muted">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <% if @sellers.any? %>
            <% @sellers.each do |seller| %>
              <tr>
                <td class="fw-semibold px-4">
                  <%= link_to seller.name, seller_path(seller), class: "link-primary link-underline-opacity-0" %>
                </td>
                <td class="px-4"><span class="badge text-bg-primary"><%= seller.seller_code %></span></td>
                <td class="px-4"><%= seller.user&.email %></td>
                <td class="text-end px-4">
                  <div class="btn-group btn-group-sm">
                    <%= link_to raw('<i class="bi bi-eye"></i>'), seller_path(seller), class: "btn btn-outline-primary rounded-circle", title: "Ver" %>
                  </div>
                </td>
              </tr>
            <% end %>
          <% else %>
            <tr>
              <td colspan="4">
                <div class="p-5 text-center text-muted">
                  <div class="bg-light rounded-circle p-4 mb-3 d-inline-block">
                    <i class="bi bi-person-badge fs-1 text-muted"></i>
                  </div>
                  <p class="mb-0 fw-semibold">No hay vendedores que coincidan con los filtros</p>
                  <p class="small text-muted">Intenta ajustar los criterios de búsqueda</p>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="card-footer bg-white">
      <div class="d-flex justify-content-center m-0">
        <%= paginate @sellers %>
      </div>
    </div>
  </div>
</div>