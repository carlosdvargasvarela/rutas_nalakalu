# app/views/deliveries/index.xlsx.axlsx
wb = xlsx_package.workbook
wb.add_worksheet(name: "Entregas") do |sheet|
  sheet.add_row [
    "Fecha de entrega", "Pedido", "Producto", "Cantidad", "Vendedor", "Cliente", "Direcci√≥n", "Estado", "Tipo"
  ]
  
  # Usar @all_deliveries en lugar de @deliveries para obtener todos los registros
  @all_deliveries.each do |delivery|
    delivery.delivery_items.each do |delivery_item|
      sheet.add_row [
        delivery.delivery_date.strftime("%d/%m/%Y"),
        delivery.order.number,
        delivery_item.order_item.product,
        delivery_item.quantity,
        delivery.order.seller.seller_code,
        delivery.order.client.name,
        delivery.delivery_address.address,
        delivery.display_status,
        delivery.delivery_type_humanize
      ]
    end
  end
end