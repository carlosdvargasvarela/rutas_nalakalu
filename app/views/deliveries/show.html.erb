<h1>Detalles de Entrega #<%= @delivery.id %></h1>

<div class="card mb-3">
  <div class="card-header">
    Información General
  </div>
  <div class="card-body">
    <p><strong>Fecha de Entrega:</strong> <%= l @delivery.delivery_date, format: :long %></p>
    <p><strong>Estado:</strong> <%= @delivery.status.humanize %></p>
    <p><strong>Preferencia de Hora:</strong> <%= @delivery.delivery_time_preference.presence || 'No especificado' %></p>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header">
    Información del Pedido
  </div>
  <div class="card-body">
    <p><strong>Número de Pedido:</strong> <%= @delivery.order.number %></p>
    <p><strong>Cliente:</strong> <%= @delivery.order.client.name %></p>
    <p><strong>Vendedor:</strong> <%= @delivery.order.seller.name %> (<%= @delivery.order.seller.seller_code %>)</p>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header">
    Detalles de Entrega
  </div>
  <div class="card-body">
    <p><strong>Dirección:</strong> <%= @delivery.delivery_address.address %></p>
    <p><strong>Contacto:</strong> <%= @delivery.contact_name %></p>
    <p><strong>Teléfono Contacto:</strong> <%= @delivery.contact_phone.presence || 'No especificado' %></p>
    <p><strong>Cédula Contacto:</strong> <%= @delivery.contact_id.presence || 'No especificado' %></p>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header">
    Productos en esta Entrega
  </div>
  <div class="card-body">
    <% if @delivery.delivery_items.any? %>
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Observaciones</th>
            <th>Caso Servicio</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
          <% @delivery.delivery_items.each do |item| %>
            <tr>
              <td><%= item.order_item.product %></td>
              <td><%= item.quantity_delivered %></td>
              <td><%= item.order_item.notes.presence || 'N/A' %></td>
              <td><%= item.service_case? ? 'Sí' : 'No' %></td>
              <td><%= item.status.humanize %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p>No hay productos asociados a esta entrega.</p>
    <% end %>
  </div>
</div>

<%= link_to "Volver a Entregas", deliveries_path, class: "btn btn-secondary" %>