<%# app/views/deliveries/_client_fields.html.erb %>
<div class="card shadow-sm mb-4">
  <div class="card-header bg-light">
    <i class="bi bi-person me-2 text-primary"></i><strong>Cliente</strong>
  </div>
  <div class="card-body">
    <div class="row g-3">
      <div class="col-md-8">
        <%= select_tag :client_id,
          options_from_collection_for_select(clients, :id, :name, f.object.order&.client_id),
          class: "form-select",
          data: { "delivery-form-target": "clientSelect", action: "change->delivery-form#clientChanged" } %>
      </div>
      <div class="col-md-4 d-flex align-items-end">
        <% unless f.object.persisted? %>
          <button type="button"
                  class="btn btn-outline-primary btn-sm"
                  data-action="click->delivery-form#toggleNewClientFields"
            data-delivery-form-target="addClientButton">
            <i class="bi bi-person-plus me-1"></i> Nuevo cliente
          </button>
        <% end %>
      </div>
    </div>
    <% unless f.object.persisted? %>
      <div data-delivery-form-target="newClientFields" class="card card-body border-primary mt-3" style="display:none;">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="fw-bold text-primary"><i class="bi bi-person me-2"></i>Datos del nuevo cliente</span>
          <button type="button" class="btn btn-outline-danger btn-sm"
                  data-action="click->delivery-form#cancelNewClientFields">
            <i class="bi bi-x-lg"></i>
          </button>
        </div>
        <div class="row g-3">
          <div class="col-md-6"><%= text_field_tag "client[name]", nil, class:"form-control", placeholder:"Nombre completo" %></div>
          <div class="col-md-3"><%= text_field_tag "client[phone]", nil, class:"form-control", placeholder:"TelÃ©fono" %></div>
          <div class="col-md-3"><%= email_field_tag "client[email]", nil, class:"form-control", placeholder:"Correo" %></div>
        </div>
      </div>
    <% end %>
  </div>
</div>