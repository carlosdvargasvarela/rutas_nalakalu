<%# app/views/deliveries/_form.html.erb %>
<%= simple_form_for delivery, html: {
      data: {
        controller: "delivery-form",
        "delivery-form-addresses-url-value": addresses_for_client_deliveries_path,
        "delivery-form-orders-url-value": orders_for_client_deliveries_path
      }
    } do |f| %>
  <%= render "deliveries/upsert_partials/client_fields", f: f, clients: clients %>
  <%= render "deliveries/upsert_partials/address_fields", f: f, addresses: addresses, delivery: delivery %>
  <%= render "deliveries/upsert_partials/order_fields", f: f %>
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-light">
      <i class="bi bi-calendar-event me-2 text-primary"></i><strong>Datos de entrega</strong>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <% unless current_user.seller? && !delivery.new_record? %>
          <div class="col-md-4">
            <%= f.date_field :delivery_date, as: :date, label: "Fecha *", input_html: { class: "form-control" } %>
          </div>
        <% end %>
        <div class="col-md-4">
          <%= f.input :contact_name, label: "Contacto", input_html: { class: "form-control" } %>
        </div>
        <div class="col-md-4">
          <%= f.input :contact_phone, label: "TelÃ©fono", input_html: { class: "form-control" } %>
        </div>
        <div class="col-12">
          <%= f.input :delivery_notes, as: :text, label: "Notas", input_html: { class: "form-control", rows: 2 } %>
        </div>
        <div class="col-md-6">
          <%= f.input :delivery_time_preference,
              label: "Preferencia de horario",
              input_html: { class: "form-control", placeholder: "Ej: MaÃ±ana, Por la tarde, 2:00 pm" } %>
        </div>
      </div>
    </div>
  </div>
  <%= render "deliveries/upsert_partials/order_items_fields", f: f %>
  <div class="d-flex justify-content-end gap-2">
    <%= link_to "Cancelar", deliveries_path, class: "btn btn-outline-secondary" %>
    <%= f.submit "Guardar entrega", class: "btn btn-primary" %>
  </div>
<% end %>